import Content from "../../content";
import Code from "../../code";
import solidDemoCode from "./index.tsx?raw";
import useSolidDataset from "./useSolidDataset.ts?raw";
import solidAlternativeDemo from "./demo.alternative.tsx?raw";
import Walkthrough from "../../walkthrough";
import CodeLink from "../../code-link";

<Content>
    <h2 className="subtitle">Code</h2>

    This demo requires you to authenticate with a Solid account.
</Content>

<Code language="tsx" id="InruptSolidDemo" code={solidDemoCode} className="line-numbers">
    <Walkthrough>
        <tr>
            <td>
                <CodeLink id="InruptSolidDemo" lines={["14-15"]}>Setting up dataset and session</CodeLink>
            </td>
            <td>
                Like with the local demo we set up the `SolidDataset`, but this time we make use of `useSolidAuth` to
                retrieve data about the WebID.
            </td>
        </tr>
        <tr>
            <td>
                <CodeLink id="InruptSolidDemo" lines={["16-17"]}>Getting profile and name</CodeLink>
            </td>
            <td>
                This part is also similar to the local part, but since there are some more moving parts with the actual
                fetching of online resources we need to put in some more safeguards.
            </td>
        </tr>
        <tr>
            <td>
                <CodeLink id="InruptSolidDemo" lines={["20-21"]}>Fetching resource and parsing dataset</CodeLink>
            </td>
            <td>Using `getSolidDataset` we have an easy, asynchronous function to get the dataset.</td>
        </tr>
        <tr>
            <td>
                <CodeLink id="InruptSolidDemo" lines={["24-26"]}>Loading state</CodeLink>
            </td>
            <td>Again, similar approach like the local demo (as well as same flaw, same excuse).</td>
        </tr>
        <tr>
            <td>
                <CodeLink id="InruptSolidDemo" lines={["29-32"]}>Updating online resources upon submit</CodeLink>
            </td>
            <td>
                Once we submit a name we make sure to update the profile with the updated name, then update the dataset
                with the updated profile, and making a request using `saveSolidDatasetAt` to save the changes to the
                online resource. We then update our local copy of the dataset to make sure all is updated.
            </td>
        </tr>
    </Walkthrough>
</Code>

<Content>
    To be fair to Inrupt's library, <CodeLink id="InruptSolidDemo" lines={["14-15", "25-28", "37-38"]}>a lot of this
    code</CodeLink> can be refactored into the hook `useSolidDataset`:
</Content>

<Code id="UseSolidDataset" language="typescript" code={useSolidDataset} className="line-numbers" />

<Content>
    This way we get a simplified, alternative code for our demo:
</Content>

<Code id="SolidAlternativeDemo" language="tsx" code={solidAlternativeDemo} className="line-numbers" />
